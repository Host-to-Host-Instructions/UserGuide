# Host-to-Host. Руководство пользователя

## 1. Введение

Документ описывает правила электронного документооборота корпораций и банков необходимого для осуществления платежей, конверсии валюты, функций валютного контроля и предоставления банками корпорациям отчетов, связанных с перечисленными выше сервисами и продуктами, на основе международного стандарта ISO 20022.

<div style="border: 1px solid #dbdbd6;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: #f3f3f2;
    border-radius: 4px;">
<div class="title" style="font-size: 19pt; color: #7a2518; margin-top: 0; text-align: center;">Обратите внимание!</div><p><b>Банк оставляет за собой право по своему усмотрению добавлять необязательные тэги и не отображать это в данной документации. Ваша система должна корректно обрабатывать такую ситуацию.</b></p></div>


### Правила подписания документов

Документы делятся на несколько бизнес-групп:

- Выписка (Рублёвая и Валютная)
- Платёжные поручения и Валютные переводы
- Валютный контроль (СВО, СПД, УНК, РСТС, Поручения на конверсию)
- Письма
- Управление зарплатным проектом (з/п ведомость, открытие ЛС)

Для каждой группы можно выбрать одно из правил подписания:

- Единоличная подпись
- Две подписи
- Три подписи

Это влияет на то, сколько подписей необходимо поставить перед отправкой на документ данной бизнес-группы.

Также есть бизнес-группа *Организация канала связи*. Эта группа даёт только доступ на отправку запроса по http в банк.

<div style="border: 1px solid #dbdbd6;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: #f3f3f2;
    border-radius: 4px;">
<div class="title" style="font-size: 19pt; color: #7a2518; margin-top: 0; text-align: center;">Обратите внимание!</div><p><b>Все документы, которые отправляются в систему Host-to-Host должны быть подписаны как минимум одной подписью (зависит от правила подписания)</b></p><p><b>На документ должна ставиться Усиленная квалифицированная электронная подпись (УКЭП) по формату xmldsig (подробнее в разделе SIGN)</b></p></div>
### Данные для тестирования интеграции

Тестирование проводится на тестовом стенде:

<div style="border: 1px solid #dbdbd6;
    margin-bottom: 1.25em;
    padding: 1.25em;
    background: #f3f3f2;
    border-radius: 4px;">
<div class="title" style="font-size: 19pt; color: #7a2518; margin-top: 0; text-align: center;">Важно</div>
<p><b>
<p>Адрес тестового стенда:</p>
<p>https://grampus-int.alfabank.ru</p>
</b></p>
<p>Авторизационные данные тестового стенда:</p>
<p>Для авторизации используется basic-авторизация, данные представлены ниже:</p>
<p><b>Логин: 643223</b></p>
<p><b>Пароль: 123456</b></p>
<div>
<p><b>Стенд не имеет UI!</b> Обращение происходит через методы из раздела REST</p>
</div></div>

Например,

- Получение выписки: 
    <div> <p><p> POST <b>https://grampus-int.alfabank.ru/API/v1/ISO20022/Statements</p></b></p></div>
    <div> <p><p>GET <b>https://grampus-int.alfabank.ru/API/v1/ISO20022/Statements/&lt;GrpHdr.MsgId&gt;</b></p></p></div>

- Создание платежей: 
    <div> <p><p> POST <b> https://grampus-int.alfabank.ru/API/v1/ISO20022/Payments </b></p></p></div>
    <div> <p><p>GET <b> https://grampus-int.alfabank.ru/API/v1/ISO20022/Payments/&lt;MsgId&gt;</b></p></p></div>
    <div> <p><p>GET <b> https://grampus-int.alfabank.ru/API/v1/ISO20022/Payments/Transactions/&lt;InstrId&gt;</b></p></p></div>

Для тестирования интеграции по правилу подписания **"Единоличная подпись"** рекомендуется использовать тестовую организацию:


| Поле | Значение | Комментарий
| ------------- |-------------|-------------|
| Полное наименование | Общество с ограниченной ответственностью "Тест Альфа-Линк" ||
| Сокращённое наименование | ООО "Тест Альфа-Линк" | Для рублевых платежей|
| Наименование на латинице | "Test Alfa-Link" Limited Liability Company | Для валютных платежей|
| Адрес | Москва ул. Московская 1 | Для рублевых платежей|
| Адрес на латинице | Moscow, Moscovskaya st. 1, RUSSIAN FEDERATION |  Для валютных платежей|
| ИНН | 7013602245 | Для рублевых и валютных платежей|
| ОГРН | 1092940217001 ||
| КПП | 215045470 ||
| Счёт RUB | 40702810200000000083 | Для рублевых платежей|
| Счёт USD | 40702840200000000529 | Для валютных платежей|
| Счёт EUR | 40702978200000000064 ||
| Наименование банка | АО "АЛЬФА-БАНК" | Для рублевых платежей|
| Наименование банка на латинице | AO "ALFA-BANK" | Для валютных платежей|
| Адрес банка на латинице | 27, KALANCHYOVSKAYA UL. MOSCOW RUSSIAN FEDERATION | Для валютных платежей|
| Корсчет банка | 30101810200000000593 | Для рублевых платежей|
| БИК банка | 044525593 | Для рублевых и валютных платежей|
| SWIFT-код банка | ALFARUMM |  Для валютных платежей|
| УНК | 20010160/1326/0000/2/1 ||


Для тестирования интеграции по правилу подписания **"Две подписи"** рекомендуется использовать тестовую организацию:

| Поле | Значение | Комментарий
| ------------- |-------------|-------------|
| Полное наименование | Общество с ограниченной ответственностью "Тест Альфа-Линк 2 подписи" ||
| Сокращённое наименование | ООО "Тест Альфа-Линк 2 подписи" | Для рублевых платежей|
| Наименование на латинице | "Test Alfa-Link 2 signs" Limited Liability Company | Для валютных платежей|
| Адрес | Москва ул. Московская 1 | Для рублевых платежей|
| Адрес на латинице | Moscow, Moscovskaya st. 1, RUSSIAN FEDERATION | Для валютных платежей|
| ИНН | 4739069021 ||
| КПП | 215401682 ||
| Счёт RUB | 40702810700000000130 | Для рублевых платежей|
| Счёт USD | 40702840200000000820 | Для валютных платежей|
| Счёт EUR | 40702978000000000099 | Для рублевых платежей|
| Наименование банка | АО "АЛЬФА-БАНК" ||
| Наименование банка на латинице | AO "ALFA-BANK" | Для валютных платежей|
| Адрес банка на латинице | 27, KALANCHYOVSKAYA UL. MOSCOW RUSSIAN FEDERATION | Для валютных платежей|
| Корсчет банка | 30101810200000000593 | Для рублевых платежей|
| БИК банка | 044525593 | Для рублевых и валютных платежей|
| SWIFT-код банка | ALFARUMM |  Для валютных платежей|
| УНК | 20010160/1326/0000/2/1 ||


При формировании платежей рекомендуется использовать в качестве **получателя** реквизиты организации:

| Поле | Значение | Комментарий
| ------------- |-------------|-------------|
| Полное наименование | Общество с ограниченной ответственностью "Тест Альфа-Линк Получатель" ||
| Сокращённое наименование | ООО "Тест Альфа-Линк Получатель" |  Для рублевых платежей|
| Наименование на латинице | "Test Alfa-Link Recipient" Limited Liability Company | Для валютных платежей|
| Адрес | Москва ул. Московская 1 |  Для рублевых платежей|
| Адрес на латинице | Moscow, Moscovskaya st. 1, RUSSIAN FEDERATION | Для валютных платежей|
| ИНН | 4689269939 | Для рублевых платежей|
| КПП | 355701009 ||
| Счёт RUB | 40702810300000000132 | Для рублевых платежей|
| Счёт USD | 40702840600000000734 | Для валютных платежей|
| Наименование банка | АО "АЛЬФА-БАНК" | Для рублевых платежей|
| Наименование банка на латинице | AO "ALFA-BANK" | Для валютных платежей|
| Адрес банка на латинице | 27, KALANCHYOVSKAYA UL. MOSCOW RUSSIAN FEDERATION | Для валютных платежей|
| Корсчет банка | 30101810200000000593 | Для рублевых и валютных платежей|
| БИК банка | 044525593 | Для рублевых и валютных платежей|
| SWIFT-код банка | ALFARUMM | Для валютных платежей|

Для тестирования документов ЗУП по правилу подписания **"Единоличная подпись"** рекомендуется использовать тестовую организацию:

| Поле | Значение 
| ------------- |-------------|
| Полное наименование | Общество с ограниченной ответственностью "Тест Альфа-Линк ЗУП"|
| Сокращённое наименование | ООО "Тест Альфа-Линк ЗУП"|
| ИНН | 0664010623|
| КПП | 051121188|
| Счёт RUB | 40702810800000000111|
| Наименование банка | АО "АЛЬФА-БАНК"|
| Корсчет банка | 30101810200000000593|
| БИК банка | 044525593|
| SWIFT-код банка | ALFARUMM|
| ФИО сотрудника [1] | Матросова Алина Николаевна|
| Счёт сотрудника [1] | 40817810904980000006|
| ФИО сотрудника [2] | Печкин Евгений Алексеевич|
| Счёт сотрудника [2] | 40817810504980000011|

Для тестирования документов ЗУП по правилу подписания **"Две подписи"** рекомендуется использовать тестовую организацию:

| Поле | Значение 
| ------------- |-------------|
| Полное наименование | Общество с ограниченной ответственностью "Тест Альфа-Линк ЗУП (2 подписи)"|
| Сокращённое наименование | ООО "Тест Альфа-Линк ЗУП (2 подписи)"|
| ИНН | 0435497780|
| КПП | 036287882|
| Счёт RUB | 40702810100000000222|
| Наименование банка | АО "АЛЬФА-БАНК"|
| Корсчет банка | 30101810200000000593|
| БИК банка | 044525593|
| SWIFT-код банка | ALFARUMM|
| ФИО сотрудника [1] | Аликова Евгения Марковна|
| Счёт сотрудника [1] | 40817810804980000009|
| ФИО сотрудника [2] | Петров Николай Васильевич|
| Счёт сотрудника [2] | 40817810707460000008|



### Тестовый сертификат электронной подписи:

Для подписания запросов вы можете воспользоваться тестовыми сертификатами из архива гайда, либо выпустить свой.

#### Тестовые сертификаты

Готовые тестовые сертификаты находятся в папке certificates архива данной документации.

Для тестирования по правилу подписания "Единоличная подпись" необходим один сертификат (single_sign_h2h_psw_123456.pfx).

Для правила подписания "Две подписи" - два сертификата (first_sign_h2h_psw_123456.pfx и second_sign_h2h_psw_123456.pfx).

При необходимости вы можете установить в доверенные корневые центры сертификации сертификаты УЦ Банка (cacerts.p7b), в котором были выпущены тестовые сертификаты.

#### Как выпустить сертификаты самостоятельно

Необходимо предоставить открытую часть ключа электронной подписи, который будет использоваться для подписания запросов, в формате \*.cer в кодировке DER.

Сертификат электронной подписи должен быть выпущен в аккредитованном Удостоверяющем Центре (для тестового стенда достаточно выпустить тестовый сертификат, к примеру в УЦ КриптоПро)

Более подробная инструкция о выпуске своего тестового сертификата предложена в разделе <<CERTIFICATES>>.

{{rest.md}}

<!-- ////
REST
////
include::./docs/rest.adoc[]


////
Запрос на формирование выписки
////
include::./docs/stmt_rq.adoc[]

////
Получение сформированной выписки
////
include::./docs/stmt.adoc[]

////
Получение онлайн остатка
////
include::./docs/stmt_ab_rq.adoc[]

////
Платёжное поручение
////
include::./docs/rub.adoc[]

////
Валютный перевод
////
include::./docs/fcy.adoc[]

////
Отзыв платежа
////
include::./docs/recall.adoc[]

////
Поручение на конвертацию
////
include::./docs/fx_conv.adoc[]

////
Поручение на покупку валюты
////
include::./docs/fx_buy.adoc[]

////
Поручение на продажу валюты
////
include::./docs/fx_sell.adoc[]

////
Создание контракта (УНК)
////
include::./docs/contract.adoc[]

////
Получение подтвержденного контракта (УНК)
////
include::./docs/contract_conf.adoc[]

////
Сведения о валютных операциях (СВО)
////
include::./docs/coc.adoc[]

////
Корректирующее СВО
////
include::./docs/coc_corr.adoc[]

////
Справка о подтверждающих документах
////
include::./docs/ctccr.adoc[]


////
Распоряжение о списании средств с транзитного валютного счёта (РСТС)
////
include::./docs/rls.adoc[]

////
Письма
////
include::./docs/letters.adoc[]

////
Зарплатная ведомость
////
include::./docs/payroll.adoc[]

////
Заявка на открытие ЛС
////
include::./docs/employee_account.adoc[]

////
Формирование архива с ВБК
////
include::./docs/contract_reports.adoc[]

////
Работа с файлами
////
include::./docs/files.adoc[]

////
Статусы
////
include::./docs/sts.adoc[]

////
Электронная подпись
////
include::./docs/sign.adoc[]

////
FAQ
////
include::./docs/faq.adoc[]

////
ChangeLog
////
include::changelog.adoc[] -->